<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ArchaeoChron • ArchaeoChron</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ArchaeoChron">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ArchaeoChron</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ArchaeoChron.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ArchaeoStat/ArchaeoChron/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to ArchaeoChron</h1>
                        <h4 data-toc-skip class="author">A. Philippe and
M.-A. Vibet</h4>
            
            <h4 data-toc-skip class="date">2025-05-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ArchaeoStat/ArchaeoChron/blob/master/vignettes/ArchaeoChron.Rmd" class="external-link"><code>vignettes/ArchaeoChron.Rmd</code></a></small>
      <div class="d-none name"><code>ArchaeoChron.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ArchaeoStat.github.io/ArchaeoChron/">ArchaeoChron</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/" class="external-link">ArchaeoPhases</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span> <span class="co"># MCMC diagnostic</span></span></code></pre></div>
<div class="section level2">
<h2 id="bayesian-model-for-combining-gaussian-dates">Bayesian model for combining Gaussian dates<a class="anchor" aria-label="anchor" href="#bayesian-model-for-combining-gaussian-dates"></a>
</h2>
<div class="section level3">
<h3 id="example-of-a-sunspot">Example of a sunspot<a class="anchor" aria-label="anchor" href="#example-of-a-sunspot"></a>
</h3>
<p>The sunspot data is constituted of several dates assumed to be
contemporaneous of a single event. These dates do not need any
calibration but their unit is in year before 2016.</p>
</div>
<div class="section level3">
<h3 id="simple-model-for-combining-gaussian-dates">Simple model for combining Gaussian dates<a class="anchor" aria-label="anchor" href="#simple-model-for-combining-gaussian-dates"></a>
</h3>
<p>Let’s first use a simple Bayesian model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sunspot</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MCMC1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combination_Gauss.html">combination_Gauss</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Age</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  s <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Error</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  refYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  studyPeriodMin <span class="op">=</span> <span class="fl">900</span>,</span>
<span>  studyPeriodMax <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  variable.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'theta'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output of the function <code><a href="../reference/combination_Gauss.html">combination_Gauss()</a></code> is a
Markov chain of the posterior distribution of the Bayesian model.</p>
<div class="section level4">
<h4 id="convergence-of-the-markov-chain">Convergence of the Markov chain<a class="anchor" aria-label="anchor" href="#convergence-of-the-markov-chain"></a>
</h4>
<p>First, let’s check the convergence of the Markov chain of each
parameter.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMC1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2"><p class="caption">
plot of chunk unnamed-chunk-2
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html" class="external-link">gelman.diag</a></span><span class="op">(</span><span class="va">MCMC1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Point est. Upper C.I.</span></span>
<span><span class="co">#&gt; theta          1          1</span></span></code></pre></div>
<p>The Gelman diagnotic gives point estimates about 1, so convergence is
reached.</p>
</div>
<div class="section level4">
<h4 id="statistics-of-the-posterior-distribution-of-the-event-">Statistics of the posterior distribution of the event.<a class="anchor" aria-label="anchor" href="#statistics-of-the-posterior-distribution-of-the-event-"></a>
</h4>
<p>Now, we can use the package <strong>ArchaeoPhases</strong> in order
to describe the posterior distribution of the parameters.</p>
<p>Here we will focus on the posterior distribution of the date of
interest, i.e. the parameter <em>theta</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMCSample1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">MCMC1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">MCMC1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">MCMCEvent1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/as_events.html" class="external-link">as_events</a></span><span class="op">(</span><span class="va">MCMCSample1</span>, calendar <span class="op">=</span> <span class="fu"><a href="https://packages.tesselle.org/aion/reference/gregorian.html" class="external-link">CE</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMCEvent1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-3-1.png" alt="plot of chunk unnamed-chunk-3"><p class="caption">
plot of chunk unnamed-chunk-3
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MCMCEvent1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mad mean sd  min   q1 median   q3  max start  end</span></span>
<span><span class="co">#&gt; theta 1028 1028  3 1022 1027   1028 1029 1034  1025 1032</span></span></code></pre></div>
<p>The date (mean posterior distribution) of the sunspot estimated using
a simple Bayesian model that combines dates, is dates at 1028 years
after Christ. This date is associated with a 95% confidence interval :
[1025, 1032].</p>
</div>
</div>
<div class="section level3">
<h3 id="bayesian-model-for-combining-gaussian-dates-and-handling-potential-outliers">Bayesian model for combining Gaussian dates and handling potential
outliers<a class="anchor" aria-label="anchor" href="#bayesian-model-for-combining-gaussian-dates-and-handling-potential-outliers"></a>
</h3>
<p>Let’s use the function
<code><a href="../reference/combinationWithOutliers_Gauss.html">combinationWithOutliers_Gauss()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combinationWithOutliers_Gauss.html">combinationWithOutliers_Gauss</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Age</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  s <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Error</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  refYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  outliersIndivVariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  outliersBernouilliProba <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  studyPeriodMin <span class="op">=</span> <span class="fl">800</span>,</span>
<span>  studyPeriodMax <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  variable.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'theta'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMC2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"><p class="caption">
plot of chunk unnamed-chunk-4
</p>
</div>
<p>The output of the function
<code><a href="../reference/combinationWithOutliers_Gauss.html">combinationWithOutliers_Gauss()</a></code> is a Markov chain of the
posterior distribution of the Bayesian model.</p>
<p>Here we will focus on the posterior distribution of the date of
interest i.e. the parameter ’theta*.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMCSample2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">MCMC2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">MCMC2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">MCMCEvent2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/as_events.html" class="external-link">as_events</a></span><span class="op">(</span><span class="va">MCMCSample2</span>, calendar <span class="op">=</span> <span class="fu"><a href="https://packages.tesselle.org/aion/reference/gregorian.html" class="external-link">CE</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMCEvent2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"><p class="caption">
plot of chunk unnamed-chunk-5
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MCMCEvent2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mad mean sd  min   q1 median   q3  max start  end</span></span>
<span><span class="co">#&gt; theta 1028 1028  3 1021 1027   1028 1029 1035  1025 1032</span></span></code></pre></div>
<p>The date (mean posterior distribution) of the sunspot, estimated
using a simple Bayesian model that combines dates and allows for
outliers, is dates at 1028 years after Christ. This date is associated
with a 95% confidence interval : [1025, 1032].</p>
</div>
<div class="section level3">
<h3 id="bayesian-model-for-combining-gaussian-dates-with-a-random-effect">Bayesian model for combining Gaussian dates with a random
effect<a class="anchor" aria-label="anchor" href="#bayesian-model-for-combining-gaussian-dates-with-a-random-effect"></a>
</h3>
<p>Let’s now use the function
<code><a href="../reference/combinationWithRandomEffect_Gauss.html">combinationWithRandomEffect_Gauss()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMC3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combinationWithRandomEffect_Gauss.html">combinationWithRandomEffect_Gauss</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Age</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  s <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Error</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  refYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  studyPeriodMin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  studyPeriodMax <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  variable.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'theta'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMC3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"><p class="caption">
plot of chunk unnamed-chunk-6
</p>
</div>
<p>The output of the function
<code><a href="../reference/combinationWithRandomEffect_Gauss.html">combinationWithRandomEffect_Gauss()</a></code> is a Markov chain of
the posterior distribution of the Bayesian model.</p>
<p>Here we will focus on the posterior distribution of the date of
interest i.e. the parameter ’theta*.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMCSample3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">MCMC3</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">MCMC3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">MCMCEvent3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/as_events.html" class="external-link">as_events</a></span><span class="op">(</span><span class="va">MCMCSample3</span>, calendar <span class="op">=</span> <span class="fu"><a href="https://packages.tesselle.org/aion/reference/gregorian.html" class="external-link">CE</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMCEvent3</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7"><p class="caption">
plot of chunk unnamed-chunk-7
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">M3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MCMCEvent3</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mad mean sd min   q1 median   q3  max start  end</span></span>
<span><span class="co">#&gt; theta 1027 1027  5 994 1025   1027 1029 1042  1018 1033</span></span></code></pre></div>
<p>The date (mean posterior distribution) of the sunspot, estimated
using a simple Bayesian model that combines dates and allows for random
effects, is dates at 1027 years after Christ. This date is associated
with a 95% confidence interval : [1018, 1033].</p>
</div>
<div class="section level3">
<h3 id="event-model-bayesian-model-for-combining-gaussian-dates-with-individual-random-effects">Event Model : Bayesian model for combining Gaussian dates with
individual random effects<a class="anchor" aria-label="anchor" href="#event-model-bayesian-model-for-combining-gaussian-dates-with-individual-random-effects"></a>
</h3>
<p>If we want to date that event, we can use the Event model for
combining Gaussian dates. In that example, we will investigate the
posterior distribution of the date of the event (called ’theta*) and the
posterior distribution of the dates associated with this event.</p>
<div class="section level4">
<h4 id="generating-the-markov-chain-of-the-posterior-distribution">Generating the Markov chain of the posterior distribution<a class="anchor" aria-label="anchor" href="#generating-the-markov-chain-of-the-posterior-distribution"></a>
</h4>
<p>Finally, let’s use the function <code><a href="../reference/eventModel_Gauss.html">eventModel_Gauss()</a></code> and
the first 10 dates of the dataset sunspot. The study period should be
given in calendar year (BC/AD).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMC4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eventModel_Gauss.html">eventModel_Gauss</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Age</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  s <span class="op">=</span> <span class="va">sunspot</span><span class="op">$</span><span class="va">Error</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  refYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  studyPeriodMin <span class="op">=</span> <span class="fl">900</span>,</span>
<span>  studyPeriodMax <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  variable.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'theta'</span>, <span class="st">'mu'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output of the <code><a href="../reference/eventModel_Gauss.html">eventModel_Gauss()</a></code> is the Markov chain
of the posterior distribution.</p>
</div>
<div class="section level4">
<h4 id="convergence-of-the-markov-chain-1">Convergence of the Markov chain<a class="anchor" aria-label="anchor" href="#convergence-of-the-markov-chain-1"></a>
</h4>
<p>First, let’s check the convergence of the Markov chain of each
parameter.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMC4</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9"><p class="caption">
plot of chunk unnamed-chunk-9
</p>
</div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-9-2.png" alt="plot of chunk unnamed-chunk-9"><p class="caption">
plot of chunk unnamed-chunk-9
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html" class="external-link">gelman.diag</a></span><span class="op">(</span><span class="va">MCMC4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Point est. Upper C.I.</span></span>
<span><span class="co">#&gt; mu[1]          1          1</span></span>
<span><span class="co">#&gt; mu[2]          1          1</span></span>
<span><span class="co">#&gt; mu[3]          1          1</span></span>
<span><span class="co">#&gt; mu[4]          1          1</span></span>
<span><span class="co">#&gt; mu[5]          1          1</span></span>
<span><span class="co">#&gt; theta          1          1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate psrf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1</span></span></code></pre></div>
<p>The Gelman diagnotic gives point estimates about 1, so convergence is
reached.</p>
</div>
<div class="section level4">
<h4 id="statistics-of-the-posterior-distribution-of-the-event--1">Statistics of the posterior distribution of the event.<a class="anchor" aria-label="anchor" href="#statistics-of-the-posterior-distribution-of-the-event--1"></a>
</h4>
<p>Here we will focus on the posterior distribution of the event of
interest (parameter ’theta*).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCMCSample4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">MCMC4</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">MCMC4</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">MCMCEvent4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/as_events.html" class="external-link">as_events</a></span><span class="op">(</span><span class="va">MCMCSample4</span>, calendar <span class="op">=</span> <span class="fu"><a href="https://packages.tesselle.org/aion/reference/gregorian.html" class="external-link">CE</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCMCEvent4</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/unnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10"><p class="caption">
plot of chunk unnamed-chunk-10
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">M4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MCMCEvent4</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mad mean sd  min   q1 median   q3  max start  end</span></span>
<span><span class="co">#&gt; theta 1027 1026  5 1007 1024   1027 1029 1042  1018 1034</span></span></code></pre></div>
<p>The date (mean posterior distribution) of the sunspot, estimated
using a simple Bayesian model that combines dates and allows for
individual random effects, is dates at 1026 years after Christ. This
date is associated with a 95% confidence interval : [1018, 1034].</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anne Philippe, Marie-Anne Vibet, Nantes Université, CNRS.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
